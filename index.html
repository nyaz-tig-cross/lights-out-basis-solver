<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>å¤©é‡ã•ã‚“ã®3x3ãƒ‘ã‚ºãƒ« - å®Œå…¨ç‰ˆ</title>
    <style>
        body { font-family: 'Helvetica Neue', Arial, sans-serif; display: flex; flex-direction: column; align-items: center; background-color: #eef2f3; color: #333; }
        h1 { margin-bottom: 10px; color: #2c3e50; }
        .description { max-width: 500px; text-align: center; margin-bottom: 20px; line-height: 1.6; }
        .grid { display: grid; grid-template-columns: repeat(3, 100px); grid-gap: 12px; margin-top: 10px; padding: 20px; background: #fff; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .cell { width: 100px; height: 100px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 28px; font-weight: bold; cursor: pointer; user-select: none; transition: all 0.3s; border: 2px solid #ddd; }
        .white { background-color: #fff; color: #ccc; }
        .black { background-color: #2c3e50; color: #fff; border-color: #2c3e50; }
        .controls { margin-top: 30px; display: flex; gap: 10px; }
        button { padding: 12px 24px; font-size: 16px; font-weight: bold; cursor: pointer; border: none; border-radius: 6px; transition: 0.2s; }
        .btn-reset { background-color: #95a5a6; color: white; }
        .btn-solve { background-color: #e67e22; color: white; }
        button:hover { opacity: 0.8; transform: translateY(-2px); }
        #answer-area { margin-top: 25px; padding: 15px; background: #dff9fb; border-radius: 8px; border: 1px solid #c7ecee; display: none; }
        .highlight { color: #e67e22; font-weight: bold; }
    </style>
</head>
<body>

    <h1>å¤©é‡ã•ã‚“ã®3x3ãƒ‘ã‚ºãƒ«</h1>
    <div class="description">
        ã™ã¹ã¦ã®ãƒã‚¹ã‚’ç™½è‰²ï¼ˆæ¶ˆç¯ï¼‰ã«ã™ã‚Œã°ã‚¯ãƒªã‚¢ã§ã™ã€‚<br>
        <small>â€»ã€Œè§£ãï¼ã€ã‚’æŠ¼ã™ã¨ã€ç¾åœ¨ã®é»’è‰²ãƒã‚¹ã‚’æ¶ˆã™ãŸã‚ã®åŸºæœ¬å½¢ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚</small>
    </div>

    <div class="grid" id="grid"></div>

    <div class="controls">
        <button class="btn-reset" onclick="resetGame()">ãƒªã‚»ãƒƒãƒˆ</button>
        <button class="btn-solve" onclick="showSolution()">æœ€çŸ­æ‰‹é †ï¼ˆåŸºæœ¬å½¢ï¼‰ã‚’è¡¨ç¤º</button>
    </div>

    <div id="answer-area"></div>

    <script>
        const gridElement = document.getElementById('grid');
        const answerArea = document.getElementById('answer-area');
        let board = Array(9).fill(0);

        // å„ãƒã‚¹ã®ã€Œå˜ä¸€åè»¢ãƒã‚¹åˆ—ã€ï¼ˆå•é¡Œæ–‡ã®x, y, zã¨ãã®å¯¾ç§°æ€§ã‹ã‚‰å°å‡ºï¼‰
        const singleInversions = {
            0: [1, 3, 6, 7, 8], // ãƒã‚¹1ç”¨
            1: [5, 7, 8, 9],    // ãƒã‚¹2ç”¨
            2: [1, 3, 4, 8, 9], // ãƒã‚¹3ç”¨
            3: [3, 5, 6, 9],    // ãƒã‚¹4ç”¨
            4: [2, 4, 5, 6, 8], // ãƒã‚¹5ç”¨
            5: [1, 4, 5, 7],    // ãƒã‚¹6ç”¨
            6: [1, 2, 3, 6, 7], // ãƒã‚¹7ç”¨
            7: [1, 2, 3, 5],    // ãƒã‚¹8ç”¨
            8: [2, 3, 4, 7, 9]  // ãƒã‚¹9ç”¨
        };

        function render() {
            gridElement.innerHTML = '';
            board.forEach((state, index) => {
                const cell = document.createElement('div');
                cell.className = `cell ${state === 0 ? 'white' : 'black'}`;
                cell.innerText = index + 1;
                cell.onclick = () => {
                    flip(index);
                    answerArea.style.display = 'none'; // ç›¤é¢ãŒå¤‰ã‚ã£ãŸã‚‰ãƒ’ãƒ³ãƒˆã‚’éš ã™
                };
                gridElement.appendChild(cell);
            });
        }

        function flip(index) {
            const row = Math.floor(index / 3);
            const col = index % 3;
            const targets = [[row, col], [row-1, col], [row+1, col], [row, col-1], [row, col+1]];
            targets.forEach(([r, c]) => {
                if (r >= 0 && r < 3 && c >= 0 && c < 3) {
                    const targetIndex = r * 3 + c;
                    board[targetIndex] = 1 - board[targetIndex];
                }
            });
            render();
            checkClear();
        }

        function checkClear() {
            if (board.every(val => val === 0)) {
                setTimeout(() => alert('ğŸ‰ ã‚¯ãƒªã‚¢ï¼ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼'), 100);
            }
        }

        function resetGame() {
            board = Array(9).fill(0);
            answerArea.style.display = 'none';
            render();
        }

        // åŸºæœ¬å½¢ã®è¨ˆç®—ï¼ˆã‚½ãƒ«ãƒãƒ¼ï¼‰
        function showSolution() {
            let combined = [];
            // é»’è‰²(1)ã®ãƒã‚¹ãã‚Œãã‚Œã®å˜ä¸€åè»¢ãƒã‚¹åˆ—ã‚’ã™ã¹ã¦é›†ã‚ã‚‹
            board.forEach((state, index) => {
                if (state === 1) {
                    combined = combined.concat(singleInversions[index]);
                }
            });

            // æ€§è³ª3: é‡è¤‡ã‚’æ¶ˆã™ï¼ˆå¶æ•°å›ã¯æ¶ˆãˆã‚‹ï¼‰
            const counts = {};
            combined.forEach(num => counts[num] = (counts[num] || 0) + 1);
            const basicForm = Object.keys(counts)
                .filter(num => counts[num] % 2 !== 0)
                .map(Number)
                .sort((a, b) => a - b);

            if (basicForm.length === 0) {
                answerArea.innerHTML = "ã™ã§ã«ã‚¯ãƒªã‚¢ã•ã‚Œã¦ã„ã¾ã™ï¼";
            } else {
                answerArea.innerHTML = `ç¾åœ¨ã®ç›¤é¢ã‚’æ¶ˆã™ãŸã‚ã®åŸºæœ¬å½¢: <span class="highlight">${basicForm.join(', ')}</span>`;
            }
            answerArea.style.display = 'block';
        }

        render();
    </script>
</body>
</html>